(()=>{var Ze=Object.defineProperty,tn=Object.defineProperties;var en=Object.getOwnPropertyDescriptors;var ht=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable;var Lt=(w,R,v)=>R in w?Ze(w,R,{enumerable:!0,configurable:!0,writable:!0,value:v}):w[R]=v,D=(w,R)=>{for(var v in R||(R={}))$t.call(R,v)&&Lt(w,v,R[v]);if(ht)for(var v of ht(R))Bt.call(R,v)&&Lt(w,v,R[v]);return w},$=(w,R)=>tn(w,en(R));var Vt=w=>typeof w=="symbol"?w:w+"",st=(w,R)=>{var v={};for(var Q in w)$t.call(w,Q)&&R.indexOf(Q)<0&&(v[Q]=w[Q]);if(w!=null&&ht)for(var Q of ht(w))R.indexOf(Q)<0&&Bt.call(w,Q)&&(v[Q]=w[Q]);return v};var nn=(w,R)=>()=>(R||w((R={exports:{}}).exports,R),R.exports);var A=(w,R,v)=>new Promise((Q,P)=>{var U=E=>{try{G(v.next(E))}catch(F){P(F)}},T=E=>{try{G(v.throw(E))}catch(F){P(F)}},G=E=>E.done?Q(E.value):Promise.resolve(E.value).then(U,T);G((v=v.apply(w,R)).next())});var sn=nn(I=>{(()=>{"use strict";var w={644:(P,U,T)=>{var G=T(172),E=T(994),F=T(464),et=T.n(F),p=T(966);const{env:q}=window.__kubric_config__,{isMobile:nt}=window.__kubric_config__,rt=q==="production",lt={cloudflare:{development:"https://cf-events-passthrough.kubric-blog.workers.dev",staging:"https://cf-events-passthrough.kubric-blog.workers.dev",production:"https://events.getmodemagic.com"},leaderboard:{development:"https://play.beta.getque.ai",staging:"https://play.beta.getque.ai",production:"https://play.getque.ai"},storeFeatures:{development:"http://localhost:3002",staging:"https://mm.beta.getmason.io",production:"https://app.getmodemagic.com"}},dt=lt.cloudflare[q],rn=lt.leaderboard[q],yt=lt.storeFeatures[q],Gt=["info","debug","error","log"].reduce((t,e)=>(t[e]=(...n)=>{rt||window.console[e](...n)},t),{}),B=(t,e)=>{rt||Gt.debug(`%c [WidgetApp] ${t}`,"background: #222; color: #bada55",e)},ut=()=>window.__mmSideCart;var g=T(826),xt=T(538);const ot=((t="kenobi")=>(0,xt.build)({window:window.parent,origin:window.__kubric_config__.parentDomain,scope:t}))(g.SIDECART_V2_APP);let Ct=0;const it=(t,e)=>new Promise((n,s)=>{Ct+=1;const o=Ct;B(`[${o}] Calling method ${t} with `,e),ot.call({method:t,params:e,success:r=>{B(`[${o}] Method ${t} succeeded with payload `,r),n(r)},error:r=>{B(`[${o}] Method ${t} erred with ${r}`),s(r)}})}),z=t=>it(g.ChannelMethod.UPDATE_CART,t),Xt=()=>it(g.ChannelMethod.GET_QUERY),Pt=t=>it(g.ChannelMethod.CHECKOUT,t),Jt=t=>it(g.ChannelMethod.HELLO,t),bt=t=>it(g.ChannelMethod.GET_PRODUCTS,t),Yt=()=>it(g.ChannelMethod.CART_STATS);var Ht=T(283),jt=T(897);const Qt=t=>()=>{const e=t.getState(),[n,s]=(0,E.J0)(e);return(0,E.vJ)(()=>t.subscribe(o=>{s(o)}),[]),n},qt=t=>{const e=JSON.parse(JSON.stringify(t));return e.items=e.items.map(n=>{const{options_with_values:s,variant_options:o}=n;if(Array.isArray(s)){const r=s.findIndex(i=>i.name==="Choose Your Pack");if(r!==-1){const i=s[r];if(i.value){const a=i.value.match(/\/\/\/(.+?)%%%/);a&&a[1]&&(s[r]=$(D({},i),{value:`Choose your pack: ${a[1].trim()}`}),Array.isArray(o)&&(o[r]=`Choose your pack: ${a[1].trim()}`))}}}return n}),e},zt=t=>{const e=JSON.parse(JSON.stringify(t)),{options:n,variants:s}=e,o=/\/\/\/(.+?)%%%/,r=i=>{const a=i.match(o);return a?`Choose your pack: ${a[1].trim()}`:i};return Array.isArray(s)&&(e.variants=s.map(i=>{if((0,p.isValidString)(i.option1)&&o.test(i.option1)){const a=r(i.option1);return $(D({},i),{option1:a,options:i.options.map((l,c)=>c===0?a:l)})}return i})),Array.isArray(n)&&(e.options=n.map(l=>{var c=l,{values:i}=c,a=st(c,["values"]);return $(D({},a),{values:i.map(d=>(0,p.isValidString)(d)&&o.test(d)?r(d):d)})})),e},Wt=new Set([8938872242389,8961879998677,8921486295253,8508461809877,8374161080533,8373455487189,8192939753685,8089718030549,8025494454485,7761112137941,7447283335381,5016968822922,5016961679498,4425571664010]),Kt=t=>$(D({},t),{_rating:Wt.has(+t.id)?5:void 0}),Zt=t=>{const e=D({},t);return e.items=e.items.map(n=>(n.product_id===8928110280917&&(n._editable=!1,n._removable=!1,n._show_variant_info=!1,n._show_qty_editor=!1),n)),e},te=new Set([7406709047339]),ee=t=>$(D({},t),{_rating:te.has(+t.id)?5:void 0}),ne={"smartveda-beta":qt,"remi-club":Zt},se={"smartveda-beta":zt},re={"remi-stg":ee,"remi-club":Kt},Tt=t=>t.length>1||!t[0].variants||t[0].variants.length>1,K=t=>Array.isArray(t)?t.map(K):typeof t=="string"||typeof t=="number"||typeof t=="boolean"||!t?t:Object.keys(t).reduce((e,n)=>{const s=t[n];return Array.isArray(s)?e[n]=s.map(K):(n.endsWith("price")||n.endsWith("amount")||n.endsWith("discount"))&&typeof s=="number"?e[n]=s/100:e[n]=K(s),e},{}),oe=t=>{const e=JSON.parse(JSON.stringify(t)),{items:n=[]}=e,s=[],o=[],r=n.filter(i=>{const a=i.final_price===0;return a&&i.original_line_price!==0?o.push(i):a&&s.push(i),!a});return e.items=[...o,...r,...s],e},ie=(t,o)=>{var r=o,{variants:e,options:n}=r,s=st(r,["variants","options"]);let i=e.filter(d=>d.available),a=n;e.length===1&&e[0].title==="Default Title"&&(i=[]),n.length===1&&n[0].values.length===1&&n[0].values[0]==="Default Title"&&(a=[]);let l=$(D({},s),{variants:i,options:a});const c=se[t];return(0,p.isFunction)(c)&&(l=c(l)),l},ae=(t,e,n,s)=>{const o=JSON.parse(JSON.stringify(e)),{items:r=[]}=o,i=(0,p.get)(s!=null?s:{},"bxgy.enabled",!1),a=(0,p.get)(s!=null?s:{},"bxgy.config.gets.target.products",[]),l=i&&Tt(a);return r.forEach(c=>{var V,N;const{properties:d,product_id:u,variant_id:f,quantity:m}=c,S=(0,p.isValidString)(d==null?void 0:d[g.ITEM_TIER_PROP]),h=(0,p.isValidString)(d==null?void 0:d[g.ITEM_BXGY_PROP]),b=!S&&!h,O=ie(t,n[u]);let x=-1;const k=(N=(V=O.variants)==null?void 0:V.filter(L=>{const{id:Y,available:Z,compare_at_price:H,price:y=0}=L,C=Y===f,_=H!=null?H:y;return C&&(x=_*m),!C&&Z}))!=null?N:[];h&&l?c._editable=!0:b&&k.length>0&&(c._editable=!0,c._variants={options:O.options,variants:K(O.variants)}),b&&(c._removable=!0),c._compare_at_price=x===0?void 0:x/100}),o},ce=t=>{const e=JSON.parse(JSON.stringify(t));return e.items=t.items.map(o=>{var r=o,{variant_options:n}=r,s=st(r,["variant_options"]);return $(D({},s),{variant_options:n.filter(i=>i!=="Default Title")})}),e},Et=(t,e)=>{const n=new Set(e);return t.items.filter(({properties:s})=>{const o=Object.keys(s!=null?s:{});return o.length>0&&e.length>0?o.some(r=>n.has(r)):!1}).map(s=>s.key)},le=(t,e)=>{var n;return(n=t.items.filter(({key:s})=>s===e)[0])!=null?n:null},wt=({properties:t})=>(0,p.isValidString)(t==null?void 0:t[g.ITEM_BXGY_PROP]),de=({properties:t})=>(0,p.isValidString)(t==null?void 0:t[g.ITEM_TIER_PROP]),ue=t=>wt(t)||de(t),pe=(...e)=>A(I,[...e],function*(t=[]){if(t.length>0){const{cart:n,products:s}=yield z({remove:t,avoidCartUpdateEvent:!0});return{cart:n,products:s}}return null}),Ot=t=>{var s,o;const{currency:e}=t!=null?t:{};let n="";return(0,p.isValidString)(e)&&(n=(o=(s=new Intl.NumberFormat("en-US",{style:"currency",currency:e,currencyDisplay:"narrowSymbol"}).formatToParts(0).find(r=>r.type==="currency"))==null?void 0:s.value)!=null?o:""),n},fe=(t,e)=>{const{steps:n=[]}=e,s=n.reduce((a,l)=>{const{uid:c,type:d}=l;if(d===g.DiscountType.BXGY_PRODUCTS){const[{variants:u}]=l.value,[f]=u!=null?u:[];(0,p.isValidString)(f)&&(a[c]=f)}return a},{}),o={},r=[];return{itemMap:t.items.reduce((a,l)=>{const{key:c,properties:d,variant_id:u}=l,f=d==null?void 0:d[g.ITEM_TIER_PROP];if((0,p.isValidString)(f)){a[c]=l;const m=s[f];(0,p.isUndefined)(m)||m!==`${u}`?r.push(c):o[f]=l}return a},{}),tierMap:o,invalidItems:r}},me=t=>t.reduce((e,{value:n,uid:s})=>{const[{variants:o,id:r}]=n,[i]=o!=null?o:[];return(0,p.isValidString)(i)&&e.push({id:+i,productId:+r,quantity:1,properties:{[g.ITEM_TIER_PROP]:s!=null?s:""}}),e},[]),ge=(t,{id:e,variants:n})=>t.items.some(({product_id:s,variant_id:o})=>s.toString()===`${e}`&&(!n||n.length===0||n.map(r=>`${r}`).includes(o.toString()))),he=(t,e,n)=>A(I,null,function*(){return window.fetch(`${dt}/collections/include`,{method:"POST",body:JSON.stringify({store:t,collections:n.map(({id:s})=>s),products:e.items.map(({product_id:s})=>s)})}).then(s=>s.json()).then(({data:s})=>s)}),ye=(t,e,n,s,o)=>A(I,null,function*(){const{items:r}=e,i=n===g.DiscountConditionType.MIN_CART_VALUE,{collections:a=[]}=s!=null?s:{},l=a.length>0;let c=[];l&&(c=yield he(t,e,a));const d=new Set(c);return r.reduce((u,{product_id:f,final_line_price:m,quantity:S,key:h})=>{let b=m;return i||(b=S),u+((!l||d.has(+f))&&!o.has(h)?b:0)},0)}),be=t=>{const e=Number(parseFloat(`${t}`).toFixed(2));return Number.isInteger(e),e},ve=(t,e)=>{const{nextTierPendingAmount:n,steps:s=[],completedSteps:o}=e,r=Ot(t),i=s[o],[{condition:{type:a}}]=s,l={};if(a===g.DiscountConditionType.MIN_CART_VALUE&&n>0&&(l.pendingAmount=`${r}${be(n)}`),i){const{type:c}=i;c===g.DiscountType.FIXED?l.discount=`${r}${i.value} off`:c===g.DiscountType.PERCENTAGE?l.discount=`${i.value}% off`:l.discount="a freebie"}return l},Se=(t,e,n)=>A(I,null,function*(){var Z,H;let{itemMap:s,tierMap:o,invalidItems:r}=fe(e,n);const{steps:i,applyAllFreebies:a,appliesTo:l}=n,c=i[0].condition.type,d=yield ye(t,e,c,l,new Set(Object.keys(s))),u=new Set(Object.keys(o)),{items_subtotal_price:f}=e;let m=0,S=0;const h=[],b=[];let O=!1,x=!1;for(let y=i.length-1;y>=0;y-=1){const{condition:{value:C},type:_}=i[y];if(d>=C){if(m=Math.max(m,y+1),_===g.DiscountType.FIXED||_===g.DiscountType.PERCENTAGE){if(!O){const{value:M}=i[y];S=_===g.DiscountType.FIXED?M:f*M/100,O=!0}}else if(_===g.DiscountType.FREE_SHIPPING)x=!0;else if(_===g.DiscountType.BXGY_PRODUCTS){const M=i[y],{buys:J}=M;(!J||J.length===0||J.some(tt=>ge(e,tt)))&&(a||h.length===0)&&(h.push(M),u.has(M.uid)||b.push(M))}if(!a&&O&&h.length>0)break}}if(h.length===0)r=Array.from(new Set([...r,...Object.keys(s)]));else{const y=new Set(Array.from(u));h.forEach(({uid:_})=>{y.has(_)&&y.delete(_)});const C=Array.from(y).map(_=>o[_].key);r=Array.from(new Set([...r,...C]))}const k=i.length,V=100/k;let N=V*m;if(m<k){const y=(Z=i[m])!=null?Z:i[k-1],{condition:{value:C=0}={}}=(H=i[m-1])!=null?H:{},{condition:{value:_}}=y;N+=(d-C)/(_-C)*V}N=Math.round(N*100)/100;let L=0;if(m<i.length){const{condition:{value:y}}=i[m];L=y-d}const Y=$(D({},n),{completedSteps:m,progress:N,nextTierPendingAmount:L,eligibleDiscount:S,eligibleFreebieTiers:h,pendingFreebieTiers:b,invalidItems:r,hasFreeShipping:x});return Y.discountLabels=ve(e,Y),Y}),_e=(t,e,n)=>A(I,null,function*(){const c=yield Se(t,e,n),{pendingFreebieTiers:o=[],invalidItems:r=[]}=c,i=st(c,["pendingFreebieTiers","invalidItems"]),a={avoidCartUpdateEvent:!0};let l=!1;if(r.length>0&&(l=!0,a.remove=r),o.length>0&&(a.add=me(o),l=!0),l){const d=yield z(a);return{cart:K(d.cart),productMap:d.products,discountState:i}}return{cart:e,discountState:i}}),Ce=({product_id:t,variant_id:e},{id:n,variants:s})=>t.toString()===n&&(!s||s.includes(e.toString())),Pe=(t,e)=>{const n=(0,p.get)(e,"buys.target.products",[]),{items:s}=t;let o=[...s].filter(m=>!ue(m));n.length>0&&(o=s.filter(m=>n.some(S=>Ce(m,S))));let r=0,i=0;o.forEach(({quantity:m,final_line_price:S})=>{r+=m,i+=S});const{type:a,value:l}=(0,p.get)(e,"buys.condition");let c=!1;if(a===g.DiscountConditionType.MIN_QUANTITY?c=r>=l:a===g.DiscountConditionType.MIN_CART_VALUE&&(c=i>=l),!c)return null;const{target:{products:d=[]}={},discount:{quantity:u}}=e.gets,f=(d!=null?d:[]).filter(m=>Array.isArray(m.variants)&&m.variants.length>0);return(0,p.isNullOrUndefined)(u)||u===0||f.length===0?null:{quantity:u,products:f}},Te=(t,e)=>A(I,null,function*(){const n=[],s=[];let o=0;const{title:r,gets:{target:{products:i=[]},discount:{quantity:a}}}=e,l=new Set(i.reduce((u,{id:f,variants:m=[]})=>(m.length>0?m.forEach(S=>u.push(`${f}:${S}`)):u.push(`${f}:all`),u),[]));if(t.items.forEach(u=>{const{properties:f,key:m,quantity:S,variant_id:h,product_id:b}=u,O=f==null?void 0:f[g.ITEM_BXGY_PROP];(0,p.isValidString)(O)&&(O===r&&(l.has(`${b}:all`)||l.has(`${b}:${h}`))?(s.push(u),o+=S):n.push(m))}),o>a){s.sort((f,m)=>f.quantity-m.quantity);let u=o-a;for(const f of s)if(u>0)n.push(f.key),u-=f.quantity,o-=f.quantity;else break}const c=i.map(({handle:u})=>u).filter(p.isValidString);let{products:d}=yield bt({products:c,available:!0});return d=d.reduce((u,f)=>{const{id:m,variants:S=[]}=f;if(l.has(`${m}:all`))u.push(f);else{const h=S.filter(({id:b})=>l.has(`${m}:${b}`));h.length>0&&(f.variants=h,u.push(f))}return u},[]),{state:{show:o<a,options:d,targetQuantity:a,appliedQuantity:o},remove:n}}),Ee=(t,e)=>A(I,null,function*(){var l;let n=t,s;const o=Pe(t,e);let r=!1,i={show:!1},a=[];if((0,p.isNull)(o))a=n.items.filter(wt).map(({key:c})=>c);else{const{title:c}=e,{products:d=[],quantity:u}=o;if(r=Tt(d),r){const{state:f,remove:m}=yield Te(t,e);i=f,a=m}else{a=Et(t,[g.ITEM_BXGY_PROP]);const f=[{id:+((l=d[0].variants)==null?void 0:l[0]),productId:+d[0].id,quantity:u,properties:{[g.ITEM_BXGY_PROP]:c}}];({cart:n,products:s}=yield z({add:f,remove:a,avoidCartUpdateEvent:!0})),a=[],n=K(n)}}if((a==null?void 0:a.length)>0){const c=yield pe(a);(0,p.isNullOrUndefined)(c)||({cart:n,products:s}=c,n=K(n))}return{cart:n,productMap:s,discountState:i}}),we=window.__kubric_config__.env==="production"?"https://aws-prod.getmason.io":"https://aws-staging.getmason.io",Oe={host:window.location.origin,path:window.__kubric_config__.apiRoot,headers:{"X-Kubric-App":new URLSearchParams(window.location.search).get("app")},resources:{customer:{path:"customer",services:{getQuestions:{path:"custom/widget/game/questions",method:"get"}}},form:{services:{submit:{path:"form/submit",method:"post"},getRecommendationFromSubmissionId:{path:"form/submission/recommendations",method:"get"}}},orders:{services:{create:{path:"order/create",method:"post"}}},worker:{host:dt,path:"/",services:{getDynamicQuestions:{path:"quiz/questions"},getV1Discounts:{path:"discounts/manual/codes"},getV2Discounts:{path:"v2/discounts"}}},recommendations:{services:{fetchFromFeatures:{host:yt,path:"/api/sidecart/upsell/recommendations",method:"post"},fetchFromWorker:{host:dt,path:"/upsell/recommendations",method:"post"}}},discounts:{services:{getDiscounts:{path:"discounts/getDiscountCodes",method:"get"}}},cartFeatures:{services:{get:{method:"post",host:we,path:"/api/v1/kubify/cart-features",headers:{"X-Kubric-Publish-Type":"website"},data:{store:"{{store}}",cart:"{{cart}}",features:"{{features}}",widget:"{{widget}}",template:"{{template}}"}}}}}},Ae=t=>{const e=[];for(let n=t.length-1;n>=0;n-=1){const s=t[n];if(typeof s=="string"&&s.length>0&&(e.unshift(s),s.startsWith("/")))break}return e.join("/").replace(/^\/{2,}/,"/")},Ie=(t={})=>{const e=Object.keys(t);return e.length>0?e.reduce((n,s,o)=>{const r=`${t[s]}`,i=r.length>0,a=o===e.length-1;return`${n}${o===0?"?":""}${i?`${s}=${r}`:""}${i&&!a?"&":""}`},""):""},pt=(t=>{const{host:e="",path:n="",resources:s={},headers:o={}}=t;return Object.keys(s).reduce((r,i)=>{const{services:a,path:l="",host:c=""}=s[i];return r[i]=Object.keys(a).reduce((d,u)=>{const{path:f,method:m="get",host:S="",headers:h={}}=a[u],b=Ae([n,l,f]);return d[u]={send:({data:O,query:x}={})=>{let k=S;k.length===0&&(k=c.length>0?c:e);const V=`${k}${b}${Ie(x)}`,N={method:m.toUpperCase(),headers:$(D(D({},h),o),{"Content-Type":"application/json"})};return typeof O!="undefined"&&Object.keys(O).length>0&&N.method!=="GET"&&(N.body=JSON.stringify(O)),fetch(V,N).then(L=>{if(L.ok)return L.json();throw new Error(`Failed with status ${L.status} ${L.statusText}`)})}},d},{}),r},{})})(Oe),Re=t=>{const{value:e,units:n}=t;switch(n){case"seconds":return e*1e3;case"minutes":return e*60*1e3;case"hours":return e*60*60*1e3;case"days":return e*24*60*60*1e3;default:throw new Error(`Unsupported time unit: ${n}`)}},mt=class mt{constructor(e){this.key=`${mt.storageKeyPrefix}/${e}`;const n=localStorage.getItem(this.key);this.state=n?JSON.parse(n):void 0}start(e){this.state={startTime:new Date().getTime(),data:e},this.saveToLocalStorage()}remove(){this.state=void 0,this.saveToLocalStorage()}saveToLocalStorage(){const{key:e,state:n}=this;(0,p.isNullOrUndefined)(n)?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(n))}getState(){return this.state}isRunning(e){const{state:n}=this;if((0,p.isNullOrUndefined)(n)||(0,p.isNullOrUndefined)(n.startTime))return-2;const{startTime:s}=n,r=new Date().getTime()-s,i=Re(e);return r>=i?-1:Math.floor(i-r)}};mt.storageKeyPrefix="mmsc/timers";let ft=mt;const At="upsell",It=t=>A(I,null,function*(){const e={itemProperties:{},cartProperties:{}};let n=!1;return t.items.forEach(s=>{var o;if(s.properties&&g.ITEM_UPSELL_PROP in s.properties){n=!0;const r=s.properties,{[o=g.ITEM_UPSELL_PROP]:i}=r,a=st(r,[Vt(o)]);e.itemProperties[s.key]=a}}),n&&(e.cartProperties[g.ITEM_UPSELL_PROP]=null),Object.keys(e.itemProperties).length>0||n?z(e):null}),Rt=(t,e)=>{const{attributes:n={}}=t,{discount:{enabled:s,config:o},timer:{enabled:r,config:i}}=e,{for:a}=i!=null?i:{};if(s&&(0,p.isPlainObject)(o)&&r&&(0,p.isPlainObject)(a)){const l=new ft(At),c=l.getState(),d=l.isRunning(a);if(!(0,p.isNullOrUndefined)(c)&&d>0){const{startTime:u}=c;return $(D({},n),{[g.ITEM_UPSELL_PROP]:{validFor:d,startTime:u,currentTime:new Date().getTime(),discount:o}})}}},De=(t,e)=>A(I,null,function*(){const n=Rt(e,t);(0,p.isNullOrUndefined)(n)||(yield z({cartProperties:n,avoidCartUpdateEvent:!0}))}),Dt=(t,e)=>{if((0,p.isPlainObject)(e)){if(e.type===g.DiscountType.FIXED)return Math.max(0,t-e.value);if(e.type===g.DiscountType.PERCENTAGE)return t*(1-e.value/100)}return t},Ne=t=>A(I,null,function*(){var d;const e=new ft(At),{timer:{enabled:n,config:s},discount:{config:o}}=t,{for:r}=s!=null?s:{};if(!n||(0,p.isNullOrUndefined)(r))return e.remove(),{state:"disabled",pendingTime:-1};const{stats:i}=(d=yield Yt())!=null?d:{},{lastEmptyTime:a=-1}=i!=null?i:{};let l=e.getState();if(B("Timer state",l),!(0,p.isNullOrUndefined)(l)){const{data:u}=l,{period:f,discount:m}=u,S=a>-1&&a>l.startTime,h=(r==null?void 0:r.units)!==(f==null?void 0:f.units)||(r==null?void 0:r.value)!==(f==null?void 0:f.value)||(m==null?void 0:m.type)!==(o==null?void 0:o.type)||(m==null?void 0:m.value)!==(o==null?void 0:o.value);(S||h)&&(e.remove(),l=e.getState())}l||(B("Calling start timer"),e.start({period:r,discount:o}));const c=e.isRunning(r);return B("Timer pending time: ",c),c<0?{state:"expired",pendingTime:-1}:{state:"running",pendingTime:c}}),Me=new Set(["jop-prod3","remi-stg","remi-club"]),Ue=(t,e,n)=>A(I,null,function*(){if(e===g.UpsellRecommendationType.CUSTOM)return Me.has(t)?pt.recommendations.fetchFromFeatures.send({data:{shop:t,cart:n}}):pt.recommendations.fetchFromWorker.send({data:{store:t,cart:n}});const s=yield pt.cartFeatures.get.send({data:{store:t,cart:n,features:[{id:"recommended_sidecart",settings:{}}]}});return{recommendations:(0,p.get)(s,"data.recommended_sidecart.product",[]).map(({handle:i,id:a,title:l})=>({id:a,handle:i,title:l}))}}),Fe=(t,e,n)=>A(I,null,function*(){const{pendingTime:s,state:o}=yield Ne(n),{recommendation:r}=n;if(o==="disabled"||o==="running"&&s>1){const{recommendations:i=[]}=yield Ue(t,r,e);if(i.length>0){const a={},l={},c=i.map(({id:h,handle:b,variants:O=[],variantMeta:x})=>(O.length>0&&(a[h]=new Set(O),(0,p.isNullOrUndefined)(x)||O.forEach(k=>{var L,Y,Z,H;const V=(Y=(L=x[k])==null?void 0:L.compare_at_price)!=null?Y:-1,N=(H=(Z=x[k])==null?void 0:Z.price)!=null?H:0;(0,p.isNumber)(V)&&V>-1&&(l[k]={compareAtPrice:V,price:N})})),b!=null?b:"")).filter(p.isValidString);let{products:d=[]}=yield bt({products:c,available:!0});const{discount:{config:u,enabled:f}}=n,m=f?u:void 0,S=re[t];if(d=d.map(h=>{let b=h;return a[h.id]&&(b=$(D({},h),{variants:h.variants.filter(O=>a[h.id].has(O.id.toString()))})),K(b)}).filter(h=>h.variants.length>0).map(x=>{var k=x,{price:h,variants:b=[]}=k,O=st(k,["price","variants"]);return $(D({},O),{compare_at_price:h,price:Dt(h,m),variants:b.map(Z=>{var H=Z,{id:V,price:N,compare_at_price:L}=H,Y=st(H,["id","price","compare_at_price"]);var _,X;const{compareAtPrice:y,price:C}=(_=l[V])!=null?_:{};return $(D({},Y),{id:V,compare_at_price:(0,p.isNumber)(y)?y:(X=L!=null?L:N)!=null?X:h,price:(0,p.isNumber)(C)?C:Dt(N!=null?N:h,m)})})})}).map(h=>(0,p.isFunction)(S)?S(h):h),d.length>0)return{state:{products:d,loading:!1,pendingTime:s/1e3,title:n.title,display:n.display,timerEnabled:n.timer.enabled}}}}else{const i=yield It(e);if(!(0,p.isNull)(i)){const{cart:a}=i;return{cart:a}}}return{}}),ke=(t,e,n)=>A(I,null,function*(){var S,h;const{tiered:{enabled:s,config:o},bxgy:{enabled:r,config:i},upsell:{enabled:a,config:l}={}}=n;let c,d,u=e,f;if(s&&(0,p.isPlainObject)(o)){const b=yield _e(t,e,o);(0,p.isPlainObject)(b)&&({discountState:c,cart:u}=b,f=(S=b.productMap)!=null?S:f)}if(r&&(0,p.isPlainObject)(i)){const b=yield Ee(u,i);({discountState:d,cart:u}=b),f=(h=b.productMap)!=null?h:f}let m;if(a&&(0,p.isPlainObject)(l)){const b=yield Fe(t,e,l);(0,p.isUndefined)(b.cart)||(u=b.cart),m=b.state}return{tieredDiscountState:c,cart:u,productMap:f,bxgyDiscountState:d,upsellDiscountState:m}}),Le=(t,e)=>A(I,null,function*(){try{const n=t.items.map(r=>r.product_id.toString());if(n.length===0)return t;let s;if(e)s=e;else{const{products:r}=yield bt({products:n,available:!0});s={},r.forEach(i=>{s[i.id.toString()]=i})}const o=t.items.map(r=>{const i=s[r.product_id.toString()];if(!i||!i.selling_plan_groups)return r;const a=i.selling_plan_groups.reduce((l,c)=>{if(c.name.includes("[hidden]"))return l;const d=c.selling_plans.reduce((u,f)=>{var m,S;return f.name.startsWith("{{H}}")||u.push({label:(S=(m=f.options[0])==null?void 0:m.value)!=null?S:f.name,id:f.id}),u},[]);return[...l,...d]},[]);return $(D({},r),{_sellingPlans:a})});return $(D({},t),{items:o})}catch(n){return console.error("Failed to add selling plans to cart:",n),t}}),Nt=(t,e,n,{convertPrice:s=!0,discount:o}={})=>{let r=e;return s&&(r=K(r)),r=ae(t,r,n,o),r=oe(r),r=ce(r),r},$e=(t,e,n,s)=>A(I,null,function*(){var S;let o=JSON.parse(JSON.stringify(e)),r=n;const i=(0,p.get)(s,"bxgy.enabled",!1),a=(0,p.get)(s,"tiered.enabled",!1),l=[...g.deprecatedMMProps];i||l.push(g.ITEM_BXGY_PROP),a||l.push(g.ITEM_TIER_PROP);const c=Et(e,l);if(c.length>0){const b=yield z({remove:c,avoidCartUpdateEvent:!0});o=b.cart,r=b.products}o=K(o);let d,u,f;if(s){const h=yield ke(t,o,s);({tieredDiscountState:d,cart:o,bxgyDiscountState:u,upsellDiscountState:f}=h),r=(S=h.productMap)!=null?S:r}o=Nt(t,o,r,{convertPrice:!1,discount:s}),o=yield Le(o,r);const m=ne[t];return(0,p.isFunction)(m)&&(o=m(o)),{cart:o,tieredDiscountState:d,bxgyDiscountState:u,upsellDiscountState:f}});var Mt=(t=>(t.PROCESSING="processing",t.READY="ready",t))(Mt||{});const Be=(0,Ht.y)()((0,jt.D)((t,e)=>({cartOpen:!1,cartState:"processing",cart:null,tieredDiscountState:void 0,bxgyDiscountState:void 0,upsellDiscountState:void 0,storeData:void 0,features:{[g.CartFeature.BXGY_BANNER]:{isLoading:!1,data:"disabled"}},setStoreData:n=>{t(s=>{s.storeData=n})},openCart:(n=!1)=>t(s=>{s.cartOpen=!0,n&&(s.cart=null)}),closeCart:()=>t(n=>{n.cartOpen=!1}),processCart:(n,s,o)=>A(I,null,function*(){const{storeData:r}=e(),{store:i}=r!=null?r:{};if((0,p.isValidString)(i)){t(u=>{u.cartState="processing"});const{cart:a,tieredDiscountState:l,bxgyDiscountState:c,upsellDiscountState:d}=yield $e(i,n,s,o);t(u=>{u.cartState="ready",u.cart=a,u.tieredDiscountState=l,u.bxgyDiscountState=c,u.upsellDiscountState=d,B("Marking cart as READY"),B("Updating cart",a),B("Updating tiered discount",l),B("Updating bxgy discount",l),B("Updating upsell discount",d)})}}),updateCart:n=>{t(s=>{s.cartState="ready",s.cart=n})},clearUpsellDiscountState:()=>t(n=>{n.upsellDiscountState=void 0}),setFeatureLoading:(n,s=!0)=>{t(o=>{o.features[n].isLoading=s})},setFeatureData:(n,s)=>{t(o=>{o.features[n].isLoading=!1,o.features[n].data=s})}}))),at=Qt(Be),Ve=()=>{const{cartOpen:t,closeCart:e,openCart:n}=at();return(0,E.vJ)(()=>(ot.bind(g.ChannelMethod.OPEN_CART,(o,{loading:r=!1}={})=>{n(r)}),()=>{ot.unbind(g.ChannelMethod.OPEN_CART)}),[]),{cartOpen:t,closeCart:()=>{e(),B("CLOSE_CART event called"),setTimeout(()=>{ot.call({method:g.ChannelMethod.CLOSE_CART,success:()=>{B("CLOSE_CART event acked")}})},300)}}},Ge=()=>{const{setStoreData:t}=at(),e=ut();(0,E.vJ)(()=>{var n;if((0,p.isPlainObject)(e)){const{config:s}=e,{addons:o}=s!=null?s:{},{enabled:r,config:i}=(n=o==null?void 0:o[g.Addon.LAUNCHER])!=null?n:{};B("Calling HELLO"),Jt({message:g.HELLO_MESSAGE,launcher:r?i:void 0}).then(a=>{const{message:l,storeData:c}=a;l===g.ACK_HELLO_MESSAGE&&(B(`Response to HELLO received with message "${g.ACK_HELLO_MESSAGE}"`),B("Received store data",c),(0,p.isPlainObject)(c)&&t(c))}).catch(a=>{B("HELLO message failed",a)})}},[JSON.stringify(e)])},Ut=()=>{var H;const{processCart:t,cartState:e,cart:n,tieredDiscountState:s,storeData:o,bxgyDiscountState:r,upsellDiscountState:i}=at(),{discount:a,config:l,uid:c}=(H=ut())!=null?H:{},{checkout:{type:d=g.CheckoutType.SHOPIFY}={}}=l!=null?l:{},u=(0,p.get)(a,"bxgy.config.title",""),f=(0,p.get)(a,"upsell.config",""),m=({subCategory:y,subscription:C}={})=>({app_name:"sidecart",categories:"side-cart",storyboard_id:"",template_id:c!=null?c:"",widget_id:c!=null?c:"",sub_category:(0,p.isNullOrUndefined)(y)?void 0:y,subscription:C}),S={[g.ATTRIBUTION_PROP]:m()};let h={};(0,p.isValidString)(u)&&(h={[g.ATTRIBUTION_PROP]:m({subCategory:g.AttributionSubCategory.BXGY}),[g.ITEM_BXGY_PROP]:u});let b={};if((0,p.isPlainObject)(f)){const{title:y}=f;b={[g.ATTRIBUTION_PROP]:m({subCategory:g.AttributionSubCategory.CART_UPSELL}),[g.ITEM_UPSELL_PROP]:{title:y,from:g.UpsellFrom.SIDECART}}}const O=y=>A(I,null,function*(){const{cart:C,products:_}=yield z({updateQuantity:y,avoidCartUpdateEvent:!0});t(C,_,a)}),x=X=>A(I,[X],function*({variantId:y,intent:C,productId:_}){const M={id:+y,productId:+_,quantity:1,properties:S},{cart:J,products:j}=yield z({add:[M],avoidCartUpdateEvent:!0,intent:C});t(J,j,a)}),k=y=>A(I,null,function*(){const{cart:C,products:_}=yield z({remove:[y],avoidCartUpdateEvent:!0});t(C,_,a)}),V=y=>A(I,null,function*(){const C=(y!=null?y:"").toUpperCase(),{cart:_,products:X}=yield z({discountCode:C,avoidCartUpdateEvent:!0}),{discount_codes:M=[]}=_;if((0,p.isValidString)(C)){const j=C.split(",").map(W=>W.trim()).filter(W=>W.length>0),tt=new Set(M.filter(({applicable:W})=>W).map(({code:W})=>W.toUpperCase())),ct=j.every(W=>tt.has(W)),gt=new Set(j),_t=Array.from(tt).some(W=>!gt.has(W));if(!ct||_t)throw new Error("Unable to update coupon")}else if(M.some(({applicable:tt})=>tt))throw new Error("Unable to update coupon");t(_,X,a)}),N=y=>A(I,null,function*(){const{add:C=[],remove:_=[],from:X,intent:M}=y,J=X==="upsell";if(C.length>0||_.length>0){let j;J&&!(0,p.isNull)(n)&&(j=Rt(n,f));const tt=C.map(_t=>$(D({},_t),{properties:D(D({},S),J?b:h)})),{cart:ct,products:gt}=yield z(JSON.parse(JSON.stringify({remove:_,cartProperties:j,add:tt,avoidCartUpdateEvent:!0,intent:M})));t(ct,gt,a)}}),L=y=>A(I,null,function*(){const{lineKey:C,quantity:_,variant:X,productId:M}=y,{cart:J,products:j}=yield z({remove:[C],add:[{id:X,quantity:_,productId:M}]});t(J,j,a)}),Y=y=>A(I,null,function*(){var ct;const{lineKey:C,sellingPlanId:_}=y,{properties:X={}}=(ct=le(n,C))!=null?ct:{},M=X==null?void 0:X[g.ATTRIBUTION_PROP];let J=m({subscription:!0});if((0,p.isValidString)(M))try{J=JSON.parse(M),J.subscription=!0}catch(gt){}const{cart:j,products:tt}=yield z({sellingPlan:{[C]:_},itemProperties:{[C]:$(D({},X),{[g.ATTRIBUTION_PROP]:J})}});t(j,tt,a)}),Z=()=>A(I,null,function*(){const y=()=>A(I,null,function*(){(0,p.isPlainObject)(f)&&(yield De(f,n))});if(d===g.CheckoutType.SHOPIFY)return yield y(),Pt({checkoutType:d});const{shopUrl:C="",deviceId:_,store:X}=o!=null?o:{},M=yield Xt(),{data:J,invoice_url:j}=yield pt.orders.create.send({data:{cart:n,discount:void 0,shop:X,widget:c,useCartDiscount:!0,query:M,pageUrl:C,deviceId:_}});return yield y(),Pt({checkoutType:d,orderData:J,invoiceUrl:j})});return(0,E.vJ)(()=>{let y=!1;try{ot.bind(g.ChannelMethod.CART,(C,_)=>{B("Received CART event with params",_);const{cart:X,products:M}=_;t(X,M,a)}),y=!0}catch(C){y=!1}return()=>{y&&ot.unbind(g.ChannelMethod.CART)}},[]),{cart:e===Mt.READY?n:null,tieredDiscountState:s,updateQuantity:O,addItem:x,removeItem:k,applyDiscount:V,checkout:Z,editItem:L,bxgyDiscountState:r,upsellDiscountState:i,updateSelection:N,updateSellingPlan:Y}},xe=()=>{const{addItem:t,removeItem:e,updateQuantity:n,applyDiscount:s,checkout:o,editItem:r,updateSelection:i,updateSellingPlan:a}=Ut();return{addItem:t,removeItem:e,updateQuantity:n,applyDiscount:s,checkout:o,editItem:r,updateSelection:i,updateSellingPlan:a}},vt={},Xe=(t,e)=>{const{addQuantity:n=!1}=e!=null?e:{};return JSON.parse(JSON.stringify(t!=null?t:[])).sort((s,o)=>+s.id-+o.id).reduce((s,{id:o,quantity:r})=>`${o}${n?`:${r}`:""}:${s}`,"")},Je={[g.CartFeature.BXGY_BANNER]:"bxgy"},Ye={bxgy:{feature:g.CartFeature.BXGY_BANNER,transform:t=>{const{status:e}=t;return e}}},He=()=>{var l;const{config:t,uid:e,store:n}=(l=ut())!=null?l:{},{cart:s,setFeatureData:o,setFeatureLoading:r}=at(),{items:i=[]}=s!=null?s:{},a=c=>{Object.keys(c).forEach(d=>{const u=d;o(u,c[u])})};(0,E.vJ)(()=>{var d;if((0,p.isNullOrUndefined)(s)||(0,p.isNullOrUndefined)(t)||!(0,p.isValidString)(n)||!(0,p.isValidString)(e))return;const c=Xe(i,{addQuantity:!0});if(vt[c])a(vt[c]);else{const u={[g.CartFeature.BXGY_BANNER]:"disabled"};vt[c]=u;const{addons:f}=t!=null?t:{},{enabled:m=!1,config:{buy:S={},get:h={}}={}}=(d=f==null?void 0:f[g.Addon.BXGY_BANNER])!=null?d:{},b=[];m&&(b.push({id:Je[g.CartFeature.BXGY_BANNER],settings:{buy:S,get:h}}),r(g.CartFeature.BXGY_BANNER)),b.length>0&&pt.cartFeatures.get.send({data:{store:n,cart:s,features:b,widget:e}}).then(O=>{const{data:x}=O;Object.keys(x).forEach(k=>{var Y;const{feature:V,transform:N}=(Y=Ye[k])!=null?Y:{},L=x[k];(0,p.isValidString)(V)&&(u[V]=(0,p.isFunction)(N)?N(L):L)}),a(u)}).catch(O=>{console.error("Cart features API call failed")})}},[JSON.stringify(s),JSON.stringify(t),n,e])};var je=T(192);const Qe=()=>{var r;const{discount:t}=(r=ut())!=null?r:{},{cart:e,updateCart:n,storeData:s}=at(),{store:o=""}=s!=null?s:{};return(0,E.hb)(i=>A(I,null,function*(){if(i===je.CartEvent.UPSELL_TIMER_EXPIRED){const a=yield It(e);if(!(0,p.isNull)(a)){const{cart:l,products:c}=a,d=Nt(o,l,c,{convertPrice:!0,discount:t});n(d)}}}),[JSON.stringify(e)])},qe=`
#tieredDiscountProgress, #tieredDiscountActiveBubble, #timer {
  background: #F8728C;
}
#finalTotalPrice {
  color: #44BD6F;
}
`,Ft=`
  @font-face {
    font-family: "GT-Pressura";
    src: url("https://preview--shopremi-floaty-popups.lovable.app/fonts/GT-Pressura-Regular.woff") format("woff");
    font-weight: normal;
    font-style: normal;
    font-display: swap;
  }
  
  :root {
    --primary-color: #009CBD;
    --primary-muted-color: #99D6EA;
    --primary-bg-color: rgba(153,214,234,0.15);
    --cta-color: #FFD100;
    --text-color: #373A36;
    --text-muted-color: rgba(39,39,39,0.7);
    --green-color: #16A34A;
    --green-bg-color: #dcfce7;
    --border-color: rgb(243 244 246);
    --border-dark: rgb(226, 232, 240);
    --cart-padding: 16px;
    --gradient-bg: linear-gradient(to right, rgba(0, 146, 204, 0.1), rgba(255, 217, 0, 0.1));
    --yellow-bg-color: #FEFCE8;
  }
  
  #summarySectionContainer {
    display: block;
    padding: var(--cart-padding) var(--cart-padding) 0 var(--cart-padding);
  }
  
  #summarySectionContainer * {
    font-size: 1rem !important;
    line-height: 1.5rem !important;
  }
  
  #summarySectionContainer > div {
    margin-bottom: .5rem !important;
  }
  
  #discountSectionContainer {
    padding-top: 0;
  }
  
  #scrollBannerText {
    color: white !important;
  }
  
  #lineItemDiscountPercent, #upsellItemDiscountPercent {
    font-size: .75rem;
    line-height: 1rem;
  }
  
  #cartContainer * {
    font-family: "GT-Pressura",sans-serif !important;
    color: var(--text-color);
  }

  #upsellItemDiscountPercent {
    background-color: rgb(254, 226, 226);
    padding: 2px 10px;
    border-radius: 100px;
    color: rgb(153, 27, 27);
    display: block;
  }

  #lineItemDiscountCode {
    display: none;
  }

  #lineItemDiscountPercent {
    background-color: rgb(239, 68, 68);
    color: white;
    padding: 2px 10px;
    border-radius: 16px;
    display: block;
  }

  #upsellItemButton, #ctaSectionButton {
    background-color: var(--cta-color);
    color: var(--text-color);
  }
`,kt=`
  #discountSectionSavingsAmount, #discountSectionToPayAmount, #discountSectionOriginalTotalAmount {
    display: flex;
  }
  #discountSectionCodeAmount, #discountSectionAutoAmount, #discountSectionSubTotal {
    display: none;
  }
`,ze={"health-and-supplements-demo":qe,"remi-stg":Ft,"remi-club":Ft,thedeconstruct:kt,"jop-dev12":kt},We=(t="")=>{const e=ze[t];return(0,p.isValidString)(e)?[{value:e,type:"styles"}]:[]},St=()=>{const t=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${t}px`)},Ke=()=>{Ge(),He();const t=ut(),{cart:e,tieredDiscountState:n,bxgyDiscountState:s,upsellDiscountState:o}=Ut();B("Cart to be rendered",e);const{features:r,storeData:{store:i}={}}=at(),a=xe(),{cartOpen:l,closeCart:c}=Ve(),d=Ot(e);(0,E.vJ)(()=>{const S=h=>{h.key==="Escape"&&c()};return window.addEventListener("keydown",S),St(),window.addEventListener("resize",St),()=>{window.removeEventListener("keydown",S),window.removeEventListener("resize",St)}},[c]);const u=Qe();if((0,p.isNullOrUndefined)(t))return(0,G.h)("span",null);const{config:f,discount:m}=t;return(0,G.h)("div",{style:{position:"relative",height:"var(--cartHeight)",width:"100vw",overflow:"hidden"},onClick:c},(0,G.h)(et(),{currencySymbol:d,style:{position:"absolute",top:"0",right:"0",transform:l?"translateX(0%)":"translateX(100%)",transition:"transform 0.3s ease"},config:f,discounts:$(D({},m),{tiered:$(D({},m.tiered),{config:n}),bxgy:$(D({},m.bxgy),{config:s}),upsell:o}),cart:e,onClose:c,ops:a,features:r,onEvent:u,css:We(i)}))};(0,G.XX)((0,G.h)(Ke,null),document.getElementById("root"))}},R={};function v(P){var U=R[P];if(U!==void 0)return U.exports;var T=R[P]={exports:{}};return w[P].call(T.exports,T,T.exports,v),T.exports}v.m=w,(()=>{var P=[];v.O=(U,T,G,E)=>{if(T){E=E||0;for(var F=P.length;F>0&&P[F-1][2]>E;F--)P[F]=P[F-1];P[F]=[T,G,E];return}for(var et=1/0,F=0;F<P.length;F++){for(var[T,G,E]=P[F],p=!0,q=0;q<T.length;q++)(E&!1||et>=E)&&Object.keys(v.O).every(yt=>v.O[yt](T[q]))?T.splice(q--,1):(p=!1,E<et&&(et=E));if(p){P.splice(F--,1);var nt=G();nt!==void 0&&(U=nt)}}return U}})(),v.n=P=>{var U=P&&P.__esModule?()=>P.default:()=>P;return v.d(U,{a:U}),U},v.d=(P,U)=>{for(var T in U)v.o(U,T)&&!v.o(P,T)&&Object.defineProperty(P,T,{enumerable:!0,get:U[T]})},v.o=(P,U)=>Object.prototype.hasOwnProperty.call(P,U),v.r=P=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(P,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(P,"__esModule",{value:!0})},v.j=52,(()=>{var P={52:0};v.O.j=G=>P[G]===0;var U=(G,E)=>{var[F,et,p]=E,q,nt,rt=0;if(F.some(dt=>P[dt]!==0)){for(q in et)v.o(et,q)&&(v.m[q]=et[q]);if(p)var lt=p(v)}for(G&&G(E);rt<F.length;rt++)nt=F[rt],v.o(P,nt)&&P[nt]&&P[nt][0](),P[nt]=0;return v.O(lt)},T=self.webpackChunkwidget_app=self.webpackChunkwidget_app||[];T.forEach(U.bind(null,0)),T.push=U.bind(null,T.push.bind(T))})(),v.nc=void 0;var Q=v.O(void 0,[808,621],()=>v(644));Q=v.O(Q)})()});sn();})();
